plugins {
    id "org.jetbrains.kotlin.multiplatform"
}

apply plugin: "maven"
apply plugin: "maven-publish"


kotlin {
    if (include_js.toBoolean()) {
        js {
            browser {}
        }
    }
    jvm()

    sourceSets {
        commonMain {
            dependencies {
            }
        }
        commonTest {
            dependencies {
                implementation kotlin("test-common")
                implementation kotlin("test-annotations-common")
            }
        }
        jvmMain {
            dependencies {
                implementation kotlin("reflect")
            }
        }
        jvmTest {
            dependencies {
                implementation kotlin("test")
                implementation kotlin("test-junit")
            }
        }

        if (include_ios.toBoolean()){
            println "include_ios"
            ios {
                binaries {
                    framework {
                        baseName = "d2v-$project.name"
                    }
                }
            }
            iosSimulatorArm64()

            sourceSets {

                iosSimulatorArm64Main {
                    dependsOn(iosMain)
                }
                iosSimulatorArm64Test {
                    dependsOn(iosTest)
                }

            }
        }

        if (include_js.toBoolean()) {
            jsMain {
                dependencies {
                    implementation kotlin("stdlib-js")
                }
            }
            jsTest {
                dependencies {
                    implementation kotlin("test-js")
                }
            }
        }
    }
}
